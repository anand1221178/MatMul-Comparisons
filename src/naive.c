// Standard O(n^3) implementation