// Recursive O(n^3) implementation